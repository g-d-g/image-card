/**
 * image-card - 0.1.0
 *
 * A Custom Element for an Image Card
 *
 * http://www.emanuel-kluge.de/
 *
 * Copyright (c) 2014 Emanuel Kluge;
 * Licensed MIT
 */
!function(a,b){function c(){return++l}function d(){var a=this.images[this.current-1].naturalWidth,c=this.images[this.current-1].naturalHeight;this.querySelector(".wrapper").style.paddingBottom=c/a*100+"%",this.current>1&&(f.call(this,this.current-1),b.fireEvent(this,"change",{detail:{current:this.current}}))}function e(){for(var a,c=b.createFragment('<div>     <div class="wrapper">       <div class="wrapper-inner">         <div class="slider"></div>       </div>     </div>   </div>'),d=c.querySelector(".slider"),e=this.images,f=1;e.length;)a=e[0].cloneNode(!0),a.setAttribute("aria-hidden",f===~~this.current?"false":"true"),a.setAttribute("role","tabpanel"),a.tabIndex=-1,a.id="img-"+this.__id+"-"+f,this.hasAttribute("data-card-control")&&a.setAttribute("aria-labeledby","btn-"+this.__id+"-"+f),d.appendChild(a),e[0].remove(),f+=1;return c.childNodes[0].innerHTML}function f(a){var b;this.__slider&&(b=a*this.offsetWidth,this.__slider.style.webkitTransform="translateX(-"+b+"px) translateZ(0)",this.__slider.style.mozTransform="translateX(-"+b+"px) translateZ(0)",this.__slider.style.transform="translateX(-"+b+"px) translateZ(0)")}function g(a){k(this.images,function(b,c){b.setAttribute("aria-hidden",c===a?"false":"true")})}function h(){for(var a=this;a.parentNode;){if("IMAGE-CARD"===a.parentNode.nodeName)return a.parentNode;a=a.parentNode}return null}function i(a){var b=a.detail.current-1;k(this.buttons,function(a,c){a.classList.remove("current"),a.tabIndex=c===b?0:-1}),this.buttons[b].classList.add("current")}function j(a){this.__parent.current=a.target.getAttribute("data-index")}var k=Array.prototype.forEach.call.bind(Array.prototype.forEach),l=0,m=Object.create({lifecycle:Object.create(null),methods:Object.create(null),accessors:Object.create(null),events:Object.create(null)});m.lifecycle.created=function(){this.__id="ic-"+c(),this.current||(this.current=this.current||1),this.setAttribute("role","application"),this.setAttribute("aria-multiselectable","false"),this.querySelector("card-control")&&this.setAttribute("data-card-control",!0),b.innerHTML(this,e.call(this)+this.innerHTML),this.__slider=this.querySelector(".slider"),this.images[this.current-1]&&(this.images[this.current-1].onload=d.bind(this)),this.hasAttribute("data-card-control")||b.addEvents(this,{"keyup:keypass(37, 38)":this.prev.bind(this),"keyup:keypass(39, 40)":this.next.bind(this)}),this.tabIndex=this.hasAttribute("data-card-control")?-1:0},m.lifecycle.attributeChanged=function(a,c,d){"current"===a&&(f.call(this,d-1),g.call(this,d-1),b.fireEvent(this,"change",{detail:{current:d}}))},m.accessors.images={get:function(){return this.getElementsByTagName("img")}},m.accessors.current={attribute:{name:"current"}},m.events["dragstart:delegate(img)"]=function(a){a.preventDefault()},m.methods.prev=function(){return this.current>1&&(this.current=parseInt(this.current,10)-1),this},m.methods.next=function(){return this.current<this.images.length&&(this.current=parseInt(this.current,10)+1),this},a.ImageCard=b.register("image-card",m);var n=Object.create({lifecycle:Object.create(null),accessors:Object.create(null),events:Object.create(null)});n.lifecycle.created=function(){var a,c=h.call(this);c&&(this.__parent=c,a="",k(c.images,function(b,d){var e=d+1;a+='<button type="button" class="btn" tabindex="'+(e===~~c.current?"0":"-1")+'" role="tab" aria-controls="img-'+c.__id+"-"+e+'" id="btn-'+c.__id+"-"+e+'" data-index="'+e+'">'+e+"</button>"}),this.innerHTML=a,this.setAttribute("role","tablist"),b.addEvent(c,"change",i.bind(this)),b.addEvent(this,"click:delegate(button)",j.bind(this)))},n.accessors.buttons={get:function(){return this.getElementsByTagName("button")}},n.events["keyup:keypass(37, 38)"]=function(){this.__parent.prev(),this.buttons[this.__parent.current-1].focus()},n.events["keyup:keypass(39, 40)"]=function(){this.__parent.next(),this.buttons[this.__parent.current-1].focus()},a.CardControl=b.register("card-control",n)}(window,xtag);